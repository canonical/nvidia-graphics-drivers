nvidia-graphics-drivers-340 (340.108-0ubuntu1) focal; urgency=medium

  * New upstream release:
    - Updated the nvidia-drm kernel module for compatibility with the
      removal of the DRIVER_PRIME flag in recent Linux kernel
      versions.
    - Updated nvidia-bug-report.sh to search the systemd journal for
      gdm-x-session logs.
    - Fixed a bug that could prevent nvidia-xconfig from disabling
      the X Composite extension on version 1.20 of the X.org X
      server.
    - Fixed a build failure, "too many arguments to function
      'get_user_pages'", when building the NVIDIA kernel module for
      Linux kernel v4.4.168.
    - Fixed a build failure, "implicit declaration of function
      do_gettimeofday", when building the NVIDIA kernel module for
      Linux kernel 5.0 release candidates.
  * debian/templates/dkms_nvidia.conf.in:
    - Drop the following patches (no longer needed in 340.108):
      buildfix_kernel_5.0.patch, buildfix_kernel_5.3.patch,
      buildfix_kernel_5.4.patch.
  * debian/dkms_nvidia/patches/buildfix_kernel_4.11.patch,
    debian/dkms_nvidia/patches/do-not-call-pci_save_state.patch,
    debian/dkms_nvidia/patches/use-kmem_cache_create_usercopy-on-4.16.patch,
    debian/dkms_nvidia/patches/buildfix_kernel_5.2.patch:
    - Refresh patches.

 -- Alberto Milone <alberto.milone@canonical.com>  Wed, 08 Jan 2020 15:58:34 +0100

nvidia-graphics-drivers-340 (340.107-0ubuntu9) focal; urgency=medium

  * debian/templates/dkms_nvidia.conf.in:
    - Fall back on /usr/bin/gcc when cc is not available.

 -- Alberto Milone <alberto.milone@canonical.com>  Fri, 13 Dec 2019 11:02:19 +0100

nvidia-graphics-drivers-340 (340.107-0ubuntu8) focal; urgency=medium

  * debian/templates/dkms_nvidia.conf.in,
    debian/dkms_nvidia/patches/buildfix_kernel_5.4.patch:
    - Add support for Linux 5.4 (LP: #1850824).

 -- Alberto Milone <alberto.milone@canonical.com>  Wed, 27 Nov 2019 14:43:05 +0100

nvidia-graphics-drivers-340 (340.107-0ubuntu7) eoan; urgency=medium

  * debian/templates/dkms_nvidia.conf.in,
    debian/dkms_nvidia/patches/do-not-call-pci_save_state.patch,
    debian/dkms_nvidia/patches/disable_fstack-clash-protection_fcf-protection.patch:
    - Do not call pci_save_state() when suspending on Linux >=  4.15.0-54
      (LP: #1836630).
    - Add do-not-call-pci_save_state.patch
    - Detect the availability of the stack-clash-protection and fcf-protection
      flags in the compiler, and make sure to disable them. This fixes an
      issue when dist-upgrading from Ubuntu 19.04 (LP: #1830961).

 -- Alberto Milone <alberto.milone@canonical.com>  Thu, 10 Oct 2019 16:31:37 +0200

nvidia-graphics-drivers-340 (340.107-0ubuntu6) eoan; urgency=medium

  * debian/dkms_nvidia/patches/buildfix_kernel_5.3.patch,
    debian/templates/dkms_nvidia.conf.in:
    - Add support for Linux 5.3 (LP: #1837890).

 -- Alberto Milone <alberto.milone@canonical.com>  Tue, 13 Aug 2019 11:58:21 +0200

nvidia-graphics-drivers-340 (340.107-0ubuntu5) eoan; urgency=medium

  * debian/dkms_nvidia/patches/use-kmem_cache_create_usercopy-on-4.16.patch,
    debian/dkms_nvidia/patches/buildfix_kernel_5.2.patch,
    debian/templates/dkms_nvidia.conf.in:
    - Make sure to use kmem_cache_create_usercopy().
    - Make sure to force DRIVER_LEGACY for Linux >= 5.1.
      Thanks Satadru Pramanik for pointing to the missing fixes.

 -- Alberto Milone <alberto.milone@canonical.com>  Tue, 16 Jul 2019 16:51:31 +0200

nvidia-graphics-drivers-340 (340.107-0ubuntu4) eoan; urgency=medium

  * debian/dkms_nvidia/patches/buildfix_kernel_5.2.patch
    debian/templates/dkms_nvidia.conf.in:
    - Add support for Linux 5.2 (LP: #1830049).

 -- Alberto Milone <alberto.milone@canonical.com>  Mon, 10 Jun 2019 13:18:45 +0200

nvidia-graphics-drivers-340 (340.107-0ubuntu3) disco; urgency=medium

    * debian/dkms_nvidia/patches/buildfix_kernel_5.0.patch,
      debian/templates/dkms_nvidia.conf.in:
      - Add support for Linux 5.0. (LP: #1813064).

 -- Alberto Milone <alberto.milone@canonical.com>  Mon, 18 Feb 2019 11:59:57 +0100

nvidia-graphics-drivers-340 (340.107-0ubuntu2) cosmic; urgency=medium

  * debian/templates/nvidia-graphics-drivers.postrm.in,
    debian/templates/nvidia-graphics-drivers.preinst.in,
    debian/templates/nvidia-graphics-drivers.prerm.in:
    - Use diversions for "libGLESv1_CM.so" "libGLESv1_CM.so.1" (LP: #1791542).

 -- Alberto Milone <alberto.milone@canonical.com>  Mon, 10 Sep 2018 15:11:35 +0200

nvidia-graphics-drivers-340 (340.107-0ubuntu1) cosmic; urgency=medium

  * New upstream release:
    - Added support for X.Org xserver ABI 24 (xorg-server 1.20).
    - Improved nvidia-bug-report.sh to check for kern.log which is
      the default kernel log-file location for many Debian-based
      Linux distributions.
    - Fixed a bug which could cause X servers that export a Video
      Driver ABI earlier than 0.8 to crash when running X11
      applications which call XRenderAddTraps().
  * debian/substvars:
    - Add support for ABI 24.

 -- Alberto Milone <alberto.milone@canonical.com>  Thu, 21 Jun 2018 18:06:37 +0200

nvidia-graphics-drivers-340 (340.106-0ubuntu5) cosmic; urgency=medium

  * debian/nvidia-340.maintscript,
    debian/templates/nvidia-graphics-drivers.maintscript.in,
    debian/templates/nvidia-graphics-drivers.postinst.in:
    - Remove the blacklist file manually, since dpkg-maintscript-helper
      won't work in this case. Fixes FTBFS.

 -- Alberto Milone <alberto.milone@canonical.com>  Wed, 16 May 2018 19:30:39 +0200

nvidia-graphics-drivers-340 (340.106-0ubuntu4) cosmic; urgency=medium

  * debian/rules,
    debian/templates/nvidia-graphics-drivers.dirs.in,
    debian/templates/nvidia-graphics-drivers.maintscript.in:
    - Install the modprobe file in /lib (LP: #1761593).

 -- Alberto Milone <alberto.milone@canonical.com>  Tue, 15 May 2018 13:04:52 +0200

nvidia-graphics-drivers-340 (340.106-0ubuntu3) bionic; urgency=medium

  * debian/templates/nvidia-graphics-drivers.postrm.in,
    debian/templates/nvidia-graphics-drivers.preinst.in,
    debian/templates/nvidia-graphics-drivers.prerm.in:
    - Deal with 32 bit compatibility diversions (LP: #1753061).
  * debian/templates/control.in:
    - Conflict/replace/provide the virtual packages from the 390
      series.
    - Drop dependency on nvidia-prime and on bumblebee.

 -- Alberto Milone <alberto.milone@canonical.com>  Wed, 07 Mar 2018 17:25:19 +0100

nvidia-graphics-drivers-340 (340.106-0ubuntu2) bionic; urgency=medium

  * debian/rules,
    debian/71-nvidia.rules,
    debian/dkms_nvidia.conf,
    debian/templates/nvidia-graphics-drivers.install.in,
    debian/glamor.conf,
    debian/templates/nvidia-graphics-drivers.postinst.in,
    debian/templates/nvidia-graphics-drivers.postrm.in,
    debian/templates/nvidia-graphics-drivers.preinst.in,
    debian/templates/nvidia-graphics-drivers.prerm.in,
    debian/templates/nvidia-drm-outputclass-ubuntu.conf.in:
    - Drop the alternatives in favour of diversions, so that the
      driver can work with GLVND enabled mesa.
  * debian/substvars:
    - Depend on xserver-xorg-core (>= 2:1.19.6-1ubuntu2).

 -- Alberto Milone <alberto.milone@canonical.com>  Thu, 22 Feb 2018 14:49:43 +0100

nvidia-graphics-drivers-340 (340.106-0ubuntu1) bionic; urgency=medium

  * New upstream release:
    - Fixed a compatibility problem between the nvidia.ko's Page
      Attribute Table (PAT) support and the kernel Page Table
      Isolation (PTI) patches.
      To optimize stores to memory, nvidia.ko contains support for
      configuring the CPU's PAT registers, as a fallback for Linux
      kernels that predate kernel native PAT support.  On any recent
      kernel with CONFIG_X86_PAT enabled, the driver will detect that
      setup has already been done and skip its PAT setup.  However, a
      static inline function called by nvidia.ko's PAT fallback
      support was updated in the PTI patches to use the
      EXPORT_SYMBOL_GPL symbol 'cpu_tlbstate'. nvidia.ko was updated
      to only contain its PAT fallback support, at build time, on
      kernels without CONFIG_X86_PAT.
  * debian/templates/dkms_nvidia.conf.in:
    - Drop buildfix_kernel_4.14.patch.

 -- Alberto Milone <alberto.milone@canonical.com>  Wed, 17 Jan 2018 09:40:30 +0100

nvidia-graphics-drivers-340 (340.104-0ubuntu3) bionic; urgency=medium

  * debian/dkms/patches/buildfix_kernel_4.14.patch:
    - Fix dkms module build failures. (LP: #1727016)

 -- Seth Forshee <seth.forshee@canonical.com>  Wed, 08 Nov 2017 14:50:31 -0600

nvidia-graphics-drivers-340 (340.104-0ubuntu2) artful; urgency=medium

  * debian/dkms_nvidia/patches/buildfix_kernel_4.11.patch,
    debian/templates/dkms_nvidia.conf.in:
    - Refresh and re-enable patch for Linux 4.11, as the driver
      is still missing some changes.

 -- Alberto Milone <alberto.milone@canonical.com>  Thu, 21 Sep 2017 16:02:09 +0200

nvidia-graphics-drivers-340 (340.104-0ubuntu1) artful; urgency=medium

  * New upstream release:
    - Improved compatibility with recent Linux kernels.
  * debian/templates/dkms.conf.in:
    - Drop all the patches.

 -- Alberto Milone <alberto.milone@canonical.com>  Wed, 20 Sep 2017 16:31:36 +0200

nvidia-graphics-drivers-340 (340.102-0ubuntu5) artful; urgency=medium

  [ Seth Forshee ]
  * debian/dkms_nvidia/patches/buildfix_kernel_4.12.patch,
    debian/templates/dkms_nvidia.conf.in:
    - Add support for Linux 4.11 (LP: #1700799).

 -- Alberto Milone <alberto.milone@canonical.com>  Wed, 02 Aug 2017 18:43:58 +0200

nvidia-graphics-drivers-340 (340.102-0ubuntu4) artful; urgency=medium

  [ Seth Forshee ]
  * debian/dkms_nvidia/patches/buildfix_kernel_4.11.patch,
    debian/templates/dkms_nvidia.conf.in:
    - Add support for Linux 4.11 (LP: #1691841).

 -- Alberto Milone <alberto.milone@canonical.com>  Thu, 25 May 2017 16:19:24 +0200

nvidia-graphics-drivers-340 (340.102-0ubuntu3) zesty; urgency=medium

  * Drop nvidia-prime and bumblebee Recommends on armhf (LP: #1566446)

 -- Adam Conrad <adconrad@ubuntu.com>  Fri, 07 Apr 2017 04:57:50 -0600

nvidia-graphics-drivers-340 (340.102-0ubuntu1) zesty; urgency=medium

  * New upstream release:
    - Added support for X.Org xserver ABI 23 (xorg-server 1.19)
    - Fixed a bug that allowed nvidia-installer to attempt loading
      kernel modules that were built against non-running kernels.
  * debian/dkms_nvidia/patches/buildfix_kernel_4.10.patch,
    debian/templates/dkms_nvidia.conf.in:
    - Add support for Linux 4.10.

 -- Alberto Milone <alberto.milone@canonical.com>  Wed, 15 Feb 2017 17:34:22 +0100

nvidia-graphics-drivers-340 (340.101-0ubuntu1) zesty; urgency=medium

  * debian/dkms_nvidia/patches/buildfix_kernel_4.9.patch:
    - Refresh patch for new upstream release.
  * debian/substvars:
    - Add support for X ABI 23.

 -- Robert Hooker <sarvatt@ubuntu.com>  Thu, 15 Dec 2016 11:01:15 -0500

nvidia-graphics-drivers-340 (340.98-0ubuntu2) zesty; urgency=medium

  * debian/templates/dkms_nvidia.conf.in,
    debian/dkms_nvidia/patches/buildfix_kernel_4.9.patch:
    - Add support for Linux 4.9. Credit goes to Michael Marley for
      finding out about the new required DRIVER_LEGACY flag.

 -- Alberto Milone <alberto.milone@canonical.com>  Wed, 07 Dec 2016 18:15:14 +0100

nvidia-graphics-drivers-340 (340.98-0ubuntu1) yakkety; urgency=medium

  * debian/templates/nvidia-graphics-drivers.postinst.in:
    - Do not fail if update-initramfs is not available (LP: #1629274).
  * New upstream release:
    - Added support for the screen_info.ext_lfb_base field, on
      kernels that have it, in order to properly handle UEFI
      framebuffer consoles with physical addresses above 4GB.

 -- Alberto Milone <alberto.milone@canonical.com>  Mon, 10 Oct 2016 18:03:45 +0200

nvidia-graphics-drivers-340 (340.96-0ubuntu6) yakkety; urgency=medium

  * debian/rules, debian/templates/control.in,
    debian/templates/nvidia-graphics-drivers.dirs.in,
    debian/templates/nvidia-graphics-drivers.install.in,
    debian/templates/nvidia-graphics-drivers.postinst.in,
    debian/templates/var-lib-snapd-lib-gl.mount.in:
    - Revert bind mount unit for snappy, as it causes a regression.

 -- Alberto Milone <alberto.milone@canonical.com>  Mon, 06 Jun 2016 15:58:23 +0200

nvidia-graphics-drivers-340 (340.96-0ubuntu5) yakkety; urgency=medium

  [ Michael Vogt ]
  * debian/rules, debian/templates/control.in,
    debian/templates/nvidia-graphics-drivers.dirs.in,
    debian/templates/nvidia-graphics-drivers.install.in,
    debian/templates/nvidia-graphics-drivers.postinst.in,
    debian/templates/var-lib-snapd-lib-gl.mount.in:
    - Add bind mount unit for snappy (LP: #1588192).

 -- Alberto Milone <alberto.milone@canonical.com>  Fri, 03 Jun 2016 10:20:22 +0200

nvidia-graphics-drivers-340 (340.96-0ubuntu4) yakkety; urgency=medium

  * debian/templates/dkms_nvidia.conf.in,
    debian/dkms_nvidia/patches/buildfix_kernel_4.6.patch:
    - Add support for Linux 4.6.

 -- Alberto Milone <alberto.milone@canonical.com>  Mon, 23 May 2016 16:24:44 +0200

nvidia-graphics-drivers-340 (340.96-0ubuntu3) xenial; urgency=medium

  * debian/templates/control.in:
    - Add transitional packages for the 340-updates and the 331-updates
      flavours.

 -- Alberto Milone <alberto.milone@canonical.com>  Wed, 13 Apr 2016 17:13:11 +0200

nvidia-graphics-drivers-340 (340.96-0ubuntu2) xenial; urgency=medium

  * debian/71-nvidia.rules, debian/create-uvm-dev-node,
    debian/templates/nvidia-graphics-drivers.install.in:
    - Add support for creating the device nodes, and for
      loading the uvm module (LP: #1540896).

 -- Alberto Milone <alberto.milone@canonical.com>  Wed, 03 Feb 2016 15:39:19 +0100

nvidia-graphics-drivers-340 (340.96-0ubuntu1) xenial; urgency=medium

  * debian/templates/dkms_nvidia.conf.in:
    - Drop all the patches.
  * debian/substvars:
    - Add support for X ABI 20.
  * New upstream release:
    - Fixed a bug that could cause texture corruption in some OpenGL
      applications when video memory is exhausted by a combination
      of simultaneously running graphical and compute workloads.
    - Added support for X.Org xserver ABI 20 (xorg-server 1.18).

 -- Alberto Milone <alberto.milone@canonical.com>  Thu, 12 Nov 2015 11:45:52 +0100

nvidia-graphics-drivers-340 (340.93-0ubuntu2) xenial; urgency=medium

  * debian/templates/control.in:
    - Add dependency on xserver-xorg-legacy.

 -- Alberto Milone <alberto.milone@canonical.com>  Wed, 11 Nov 2015 17:11:19 +0100

nvidia-graphics-drivers-340 (340.93-0ubuntu1) wily; urgency=medium

  * New upstream release:
    - Fixed a bug that caused the X server to crash if an OpenGL
      application tried to allocate a drawable when GPU-accessible
      memory is exhausted.
    - Fixed a bug that could cause an Xid error when terminating a
      video playback application using the overlay presentation queue
      in VDPAU.
    - Fixed a rare deadlock condition when running applications that
      use OpenGL in multiple threads on a Quadro GPU.
    - Fixed a kernel memory leak that occurred when looping hardware-
      accelerated video decoding with VDPAU on Maxwell-based GPUs.
    - Fixed a bug that caused the X server to crash if a RandR 1.4
      output provided by a SinkOutput provider was selected as the
      primary output on X.Org xserver 1.17 and higher.
    - Fixed a bug that caused waiting on X Sync Fence objects in
      OpenGL to hang indefinitely in some cases.
    - Fixed a bug that prevented OpenGL from properly recovering from
      hardware errors or sync object waits that had timed out.

 -- Alberto Milone <alberto.milone@canonical.com>  Thu, 27 Aug 2015 13:03:32 +0200

nvidia-graphics-drivers-340 (340.76-0ubuntu3) wily; urgency=medium

  *  debian/templates/dkms_nvidia.conf.in,
     debian/dkms_nvidia/patches/buildfix_kernel_4.0.patch:
     - Add support for Linux 4.0.

 -- Alberto Milone <alberto.milone@canonical.com>  Fri, 05 Jun 2015 16:57:37 +0200

nvidia-graphics-drivers-340 (340.76-0ubuntu2) vivid; urgency=medium

  * debian/rules,
    debian/templates/control.in,
    debian/templates/dkms_nvidia_uvm.conf.in,
    debian/templates/nvidia-graphics-drivers-uvm.dirs.in,
    debian/templates/nvidia-graphics-drivers-uvm.install.in,
    debian/templates/nvidia-graphics-drivers-uvm.postinst.in,
    debian/templates/nvidia-graphics-drivers-uvm.prerm.in:
    - Build nvidia and nvidia-uvm together, as the latter
      build depends on the former (LP: #1431753).
    - Merge the -uvm package into the main nvidia driver
      package, and provide a transitional package for -uvm.
    - Make sure to remove all upstream dkms.conf files.

 -- Alberto Milone <alberto.milone@canonical.com>  Mon, 30 Mar 2015 17:09:32 +0200

nvidia-graphics-drivers-340 (340.76-0ubuntu1) vivid; urgency=medium

  * Initial release.

 -- Alberto Milone <alberto.milone@canonical.com>  Wed, 11 Feb 2015 17:25:50 +0100
